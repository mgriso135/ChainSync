{"ast":null,"code":"var _jsxFileName = \"/home/matteo/ChainSync/ChainSync/client/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport Web3 from 'web3';\nimport { ethers } from 'ethers';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction AccountConnected({\n  account\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Supply Chain Tracker\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 8,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Account connected: \", account]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 9,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 7,\n    columnNumber: 5\n  }, this);\n}\n_c = AccountConnected;\nfunction App() {\n  _s();\n  const [account, setAccount] = useState('');\n  const [products, setProducts] = useState([]);\n  const [contract, setContract] = useState(null);\n  const [selectedProductId, setSelectedProductId] = useState('');\n  const [newOwnerAddress, setNewOwnerAddress] = useState('');\n  const [price, setPrice] = useState('');\n\n  // Needed to edit a single product\n  const [selectedProduct, setSelectedProduct] = useState(null);\n  useEffect(() => {\n    const connectWallet = async () => {\n      if (window.ethereum) {\n        try {\n          const accounts = await window.ethereum.request({\n            method: 'eth_requestAccounts'\n          });\n          setAccount(accounts[0]);\n        } catch (error) {\n          console.error('Error connecting to wallet:', error);\n        }\n      }\n    };\n    if (!account) {\n      // Only connect if the account is not already set\n      connectWallet();\n    }\n  }, [account]);\n  useEffect(() => {\n    const fetchContractData = async () => {\n      try {\n        const response = await fetch('/SupplyChainTracker.json');\n        const data = await response.json();\n        const web3 = new Web3(window.ethereum);\n        const contractInstance = new web3.eth.Contract(data.abi, data.networks.development.address);\n        setContract(contractInstance);\n      } catch (error) {\n        console.error('Error fetching contract data:', error);\n      }\n    };\n    fetchContractData();\n  }, []);\n\n  // Assuming you have a provider connected to the Ethereum network\n  const provider = new ethers.providers.Web3Provider(window.ethereum);\n  const getGasPrice = async () => {\n    try {\n      const gasPrice = await provider.getGasPrice();\n      console.log('Gas Price (Wei):', gasPrice.toString()); // Output gas price in Wei\n\n      // Convert to Gwei for readability\n      const gasPriceInGwei = ethers.utils.formatUnits(gasPrice, 'gwei');\n      console.log('Gas Price (Gwei):', gasPriceInGwei);\n      return gasPrice;\n    } catch (error) {\n      console.error('Error fetching gas price:', error);\n    }\n  };\n  const getProducts = async () => {\n    try {\n      const productCount = await contract.methods.productCount().call();\n      console.log('Product Count:', productCount.toString());\n      const fetchedProducts = [];\n      for (let i = 0; i < Number(productCount); i++) {\n        const product = await contract.methods.products(i).call();\n        console.log(product.manufacturer);\n        fetchedProducts.push(product);\n      }\n      setProducts(fetchedProducts);\n    } catch (error) {\n      console.error('Error fetching products:', error);\n    }\n  };\n  const addProduct = async e => {\n    e.preventDefault();\n    const form = e.target;\n    const productName = form.productName.value;\n    const productSerialNumber = form.productSerialNumber.value;\n    const productCurrentLocation = form.productCurrentLocation.value;\n    const isForSale = form.isForSale.value === 'true';\n    const initialPrice = Web3.utils.toWei(form.initialPrice.value, 'ether');\n    console.log(initialPrice);\n    if (!productName || !productSerialNumber) {\n      alert('Please enter a product name and serial number.');\n      return;\n    }\n    try {\n      const estimatedGasPrice = await getGasPrice(); // Get the gas price\n      const gasPriceString = estimatedGasPrice.toString(); // Convert to string\n      console.log(estimatedGasPrice);\n      await contract.methods.addProduct(productName, account, productSerialNumber, account, productCurrentLocation, initialPrice, isForSale).send({\n        from: account,\n        gasPrice: gasPriceString,\n        value: initialPrice * 0.1\n      });\n      console.log('Product added successfully');\n      getProducts(); // Refresh the product list\n    } catch (error) {\n      console.error('Error adding product:', error);\n      alert('An error occurred while adding the product.');\n    }\n  };\n  const handleBuyProduct = async (productId, price) => {\n    try {\n      const priceInWei = Web3.utils.toWei(price, 'ether');\n      console.log(\"productId: \" + typeof productId + \" \" + productId.toString());\n      console.log(\"account: \" + account.toString());\n      await contract.methods.transferOwnership(productId, account, \"New location \" + productId) // Update location as needed\n      .send({\n        from: account,\n        value: priceInWei\n      });\n      console.log('Product purchased successfully');\n      getProducts(); // Refresh the product list\n    } catch (error) {\n      console.error('Error purchasing product:', error);\n    }\n  };\n  const handleProductClick = product => {\n    setSelectedProduct(product);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(AccountConnected, {\n      account: account\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: addProduct,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"productName\",\n        children: \"Product Name:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"productName\",\n        name: \"productName\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"productSerialNumber\",\n        children: \"Serial Number:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"productSerialNumber\",\n        name: \"productSerialNumber\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"productCurrentLocation\",\n        children: \"Current location:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        id: \"productCurrentLocation\",\n        name: \"productCurrentLocation\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"isForSale\",\n        children: \"For sale:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"isForSale\",\n        name: \"isForSale\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"true\",\n          children: \"True\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"false\",\n          children: \"False\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"initialPrice\",\n        children: \"Initial price (ETH):\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        id: \"initialPrice\",\n        name: \"initialPrice\",\n        step: \"0.01\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Add Product\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: getProducts,\n      children: \"Get Products\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n      children: products.map((product, index) => {\n        var _product$ownershipHis;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"Manufacturer: \", product.manufacturer, \" -\", /*#__PURE__*/_jsxDEV(\"span\", {\n            onClick: () => handleProductClick(product),\n            children: [\"ID: \", product.id.toString(), \" -\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this), \"Product: \", product.name, \" - Serial number: \", product.serialNumber, \" - Current Owner: \", product.currentOwner, \" - Current Location: \", product.currentLocation, \" - Price: \", Web3.utils.fromWei(product.price, 'ether'), \" ETH - For Sale: \", product.isForSale.toString(), product.isForSale && product.currentOwner.toString().toLowerCase() != account && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleBuyProduct(product.id, Web3.utils.fromWei(product.price, 'ether')),\n            children: \"Buy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Ownership History:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: (product === null || product === void 0 ? void 0 : (_product$ownershipHis = product.ownershipHistory) === null || _product$ownershipHis === void 0 ? void 0 : _product$ownershipHis.length) > 0 ? product.ownershipHistory.map((event, eventIndex) => /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"Transferred to: \", event.newOwner, \" on \", new Date(event.timestamp * 1000).toLocaleString(), \" - Location: \", event.newLocation]\n            }, eventIndex, true, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 9\n            }, this)) : /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"No ownership history available\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 5\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }, this), selectedProduct && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Selected Product Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"ID: \", selectedProduct.id.toString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 3\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"CD1GSyEhjlcDnYELPYlFfOe1cow=\");\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AccountConnected\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useState","useEffect","Web3","ethers","jsxDEV","_jsxDEV","AccountConnected","account","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","App","_s","setAccount","products","setProducts","contract","setContract","selectedProductId","setSelectedProductId","newOwnerAddress","setNewOwnerAddress","price","setPrice","selectedProduct","setSelectedProduct","connectWallet","window","ethereum","accounts","request","method","error","console","fetchContractData","response","fetch","data","json","web3","contractInstance","eth","Contract","abi","networks","development","address","provider","providers","Web3Provider","getGasPrice","gasPrice","log","toString","gasPriceInGwei","utils","formatUnits","getProducts","productCount","methods","call","fetchedProducts","i","Number","product","manufacturer","push","addProduct","e","preventDefault","form","target","productName","value","productSerialNumber","productCurrentLocation","isForSale","initialPrice","toWei","alert","estimatedGasPrice","gasPriceString","send","from","handleBuyProduct","productId","priceInWei","transferOwnership","handleProductClick","onSubmit","htmlFor","type","id","name","required","step","onClick","map","index","_product$ownershipHis","serialNumber","currentOwner","currentLocation","fromWei","toLowerCase","ownershipHistory","length","event","eventIndex","newOwner","Date","timestamp","toLocaleString","newLocation","_c2","$RefreshReg$"],"sources":["/home/matteo/ChainSync/ChainSync/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Web3 from 'web3';\nimport { ethers } from 'ethers'; \n\nfunction AccountConnected({ account }) {\n  return (\n    <div>\n      <h1>Supply Chain Tracker</h1>\n      <p>Account connected: {account}</p>\n    </div>\n  );\n}\n\nfunction App() {\n  const [account, setAccount] = useState('');\n  const [products, setProducts] = useState([]);\n  const [contract, setContract] = useState(null);\n  const [selectedProductId, setSelectedProductId] = useState('');\n  const [newOwnerAddress, setNewOwnerAddress] = useState('');\n  const [price, setPrice] = useState('');\n  \n  // Needed to edit a single product\n  const [selectedProduct, setSelectedProduct] = useState(null);\n\n  useEffect(() => {\n    const connectWallet = async () => {\n      if (window.ethereum) {\n        try {\n          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n          setAccount(accounts[0]);\n        } catch (error) {\n          console.error('Error connecting to wallet:', error);\n        }\n      }\n    };\n\n    if (!account) { // Only connect if the account is not already set\n      connectWallet();\n    }\n  }, [account]);\n\n  useEffect(() => {\n    const fetchContractData = async () => {\n      try {\n        const response = await fetch('/SupplyChainTracker.json');\n        const data = await response.json();\n        const web3 = new Web3(window.ethereum);\n        const contractInstance = new web3.eth.Contract(data.abi, data.networks.development.address);\n        setContract(contractInstance);\n      } catch (error) {\n        console.error('Error fetching contract data:', error);\n      }\n    };\n\n    fetchContractData();\n  }, []);\n\n\n// Assuming you have a provider connected to the Ethereum network\nconst provider = new ethers.providers.Web3Provider(window.ethereum);\n\n\n  const getGasPrice = async () => {\n  try {\n    const gasPrice = await provider.getGasPrice();\n    console.log('Gas Price (Wei):', gasPrice.toString()); // Output gas price in Wei\n\n    // Convert to Gwei for readability\n    const gasPriceInGwei = ethers.utils.formatUnits(gasPrice, 'gwei'); \n    console.log('Gas Price (Gwei):', gasPriceInGwei); \n\n    return gasPrice;\n  } catch (error) {\n    console.error('Error fetching gas price:', error);\n  }\n};\n\n\n  const getProducts = async () => {\n    try {\n      const productCount = await contract.methods.productCount().call();\n      console.log('Product Count:', productCount.toString());\n      \n      const fetchedProducts = [];\n      for (let i = 0; i < Number(productCount); i++) {\n        const product = await contract.methods.products(i).call();\n        console.log(product.manufacturer);\n        fetchedProducts.push(product);\n      }\n\n      setProducts(fetchedProducts);\n    } catch (error) {\n      console.error('Error fetching products:', error);\n    }\n  };\n\n  const addProduct = async (e) => {\n    e.preventDefault();\n    const form = e.target;\n    const productName = form.productName.value;\n    const productSerialNumber = form.productSerialNumber.value;\n    const productCurrentLocation = form.productCurrentLocation.value;\n    const isForSale = form.isForSale.value === 'true';\n    const initialPrice = Web3.utils.toWei(form.initialPrice.value, 'ether');\n\n    console.log(initialPrice);\n\n    if (!productName || !productSerialNumber) {\n      alert('Please enter a product name and serial number.');\n      return;\n    }\n\n    try {\n      const estimatedGasPrice = await getGasPrice(); // Get the gas price\n      const gasPriceString = estimatedGasPrice.toString(); // Convert to string\n      console.log(estimatedGasPrice);\n\n      await contract.methods.addProduct(\n        productName,\n        account,\n        productSerialNumber,\n        account,\n        productCurrentLocation,\n        initialPrice,\n        isForSale\n      ).send({ from: account, gasPrice: gasPriceString, value: initialPrice * 0.1 });\n      console.log('Product added successfully');\n      getProducts(); // Refresh the product list\n    } catch (error) {\n      console.error('Error adding product:', error);\n      alert('An error occurred while adding the product.');\n    }\n  };\n\n\n  const handleBuyProduct = async (productId, price) => {\n    try {\n      const priceInWei = Web3.utils.toWei(price, 'ether');\n      console.log(\"productId: \" +typeof(productId)+\" \"+ productId.toString());\n      console.log(\"account: \" + account.toString());\n  \n      await contract.methods.transferOwnership(productId, account, \"New location \" + productId) // Update location as needed\n        .send({ from: account, value: priceInWei });\n  \n      console.log('Product purchased successfully');\n      getProducts(); // Refresh the product list\n    } catch (error) {\n      console.error('Error purchasing product:', error);\n    }\n  };\n\n  const handleProductClick = (product) => {\n    setSelectedProduct(product);\n  };\n\n  return (\n    <div>\n      <AccountConnected account={account} />\n      \n      <form onSubmit={addProduct}>\n        <label htmlFor=\"productName\">Product Name:</label>\n        <input type=\"text\" id=\"productName\" name=\"productName\" required />\n        <br />\n        <label htmlFor=\"productSerialNumber\">Serial Number:</label>\n        <input type=\"text\" id=\"productSerialNumber\" name=\"productSerialNumber\" required />\n        <br />\n        <label htmlFor=\"productCurrentLocation\">Current location:</label>\n        <input type=\"text\" id=\"productCurrentLocation\" name=\"productCurrentLocation\" required />\n        <br />\n        <label htmlFor=\"isForSale\">For sale:</label>\n        <select id=\"isForSale\" name=\"isForSale\">\n          <option value=\"true\">True</option>\n          <option value=\"false\">False</option>\n        </select>\n        <br />\n        <label htmlFor=\"initialPrice\">Initial price (ETH):</label>\n        <input type=\"number\" id=\"initialPrice\" name=\"initialPrice\" step=\"0.01\" required />\n        <br />\n        <button type=\"submit\">Add Product</button>\n      </form>\n<p></p>\n      <button onClick={getProducts}>Get Products</button>\n      <ol>\n        {products.map((product, index) => (\n          <div key={index}>\n            Manufacturer: {product.manufacturer} - \n            <span onClick={() => handleProductClick(product)}>\n            ID: {product.id.toString()} -\n            </span>\n            Product: {product.name} - \n            Serial number: {product.serialNumber} - \n            Current Owner: {product.currentOwner} - \n            Current Location: {product.currentLocation} - \n            Price: {Web3.utils.fromWei(product.price, 'ether')} ETH -\n            For Sale: {product.isForSale.toString()}\n            {product.isForSale && product.currentOwner.toString().toLowerCase() != account && (\n              <button onClick={() => handleBuyProduct(product.id, Web3.utils.fromWei(product.price, 'ether'))}>\n                Buy\n            </button>\n            )}\n            <h2>Ownership History:</h2>\n    <ul>\n      {product?.ownershipHistory?.length > 0 ? (\n      product.ownershipHistory.map((event, eventIndex) => (\n        <li key={eventIndex}>\n          Transferred to: {event.newOwner} on {new Date(event.timestamp * 1000).toLocaleString()} - \n          Location: {event.newLocation} \n        </li>\n      ))): (\n        <li>No ownership history available</li>\n      )}\n    </ul>\n          </div>\n        ))}\n      </ol>\n\n      \n      {selectedProduct && (\n  <div>\n    <h2>Selected Product Details</h2>\n    {/* Display details of selectedProduct here */}\n    <p>ID: {selectedProduct.id.toString()}</p>\n    {/* ... other details ... */}\n  </div>\n)}\n\n    </div>\n  );\n}\n\nexport default App;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,IAAI,MAAM,MAAM;AACvB,SAASC,MAAM,QAAQ,QAAQ;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEhC,SAASC,gBAAgBA,CAAC;EAAEC;AAAQ,CAAC,EAAE;EACrC,oBACEF,OAAA;IAAAG,QAAA,gBACEH,OAAA;MAAAG,QAAA,EAAI;IAAoB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC7BP,OAAA;MAAAG,QAAA,GAAG,qBAAmB,EAACD,OAAO;IAAA;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAChC,CAAC;AAEV;AAACC,EAAA,GAPQP,gBAAgB;AASzB,SAASQ,GAAGA,CAAA,EAAG;EAAAC,EAAA;EACb,MAAM,CAACR,OAAO,EAAES,UAAU,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACmB,QAAQ,EAAEC,WAAW,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EAC9C,MAAM,CAACqB,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAACuB,eAAe,EAAEC,kBAAkB,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACyB,KAAK,EAAEC,QAAQ,CAAC,GAAG1B,QAAQ,CAAC,EAAE,CAAC;;EAEtC;EACA,MAAM,CAAC2B,eAAe,EAAEC,kBAAkB,CAAC,GAAG5B,QAAQ,CAAC,IAAI,CAAC;EAE5DC,SAAS,CAAC,MAAM;IACd,MAAM4B,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChC,IAAIC,MAAM,CAACC,QAAQ,EAAE;QACnB,IAAI;UACF,MAAMC,QAAQ,GAAG,MAAMF,MAAM,CAACC,QAAQ,CAACE,OAAO,CAAC;YAAEC,MAAM,EAAE;UAAsB,CAAC,CAAC;UACjFlB,UAAU,CAACgB,QAAQ,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC,CAAC,OAAOG,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;QACrD;MACF;IACF,CAAC;IAED,IAAI,CAAC5B,OAAO,EAAE;MAAE;MACdsB,aAAa,CAAC,CAAC;IACjB;EACF,CAAC,EAAE,CAACtB,OAAO,CAAC,CAAC;EAEbN,SAAS,CAAC,MAAM;IACd,MAAMoC,iBAAiB,GAAG,MAAAA,CAAA,KAAY;MACpC,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,0BAA0B,CAAC;QACxD,MAAMC,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;QAClC,MAAMC,IAAI,GAAG,IAAIxC,IAAI,CAAC4B,MAAM,CAACC,QAAQ,CAAC;QACtC,MAAMY,gBAAgB,GAAG,IAAID,IAAI,CAACE,GAAG,CAACC,QAAQ,CAACL,IAAI,CAACM,GAAG,EAAEN,IAAI,CAACO,QAAQ,CAACC,WAAW,CAACC,OAAO,CAAC;QAC3F7B,WAAW,CAACuB,gBAAgB,CAAC;MAC/B,CAAC,CAAC,OAAOR,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACvD;IACF,CAAC;IAEDE,iBAAiB,CAAC,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;;EAGR;EACA,MAAMa,QAAQ,GAAG,IAAI/C,MAAM,CAACgD,SAAS,CAACC,YAAY,CAACtB,MAAM,CAACC,QAAQ,CAAC;EAGjE,MAAMsB,WAAW,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMJ,QAAQ,CAACG,WAAW,CAAC,CAAC;MAC7CjB,OAAO,CAACmB,GAAG,CAAC,kBAAkB,EAAED,QAAQ,CAACE,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;;MAEtD;MACA,MAAMC,cAAc,GAAGtD,MAAM,CAACuD,KAAK,CAACC,WAAW,CAACL,QAAQ,EAAE,MAAM,CAAC;MACjElB,OAAO,CAACmB,GAAG,CAAC,mBAAmB,EAAEE,cAAc,CAAC;MAEhD,OAAOH,QAAQ;IACjB,CAAC,CAAC,OAAOnB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;EAGC,MAAMyB,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI;MACF,MAAMC,YAAY,GAAG,MAAM1C,QAAQ,CAAC2C,OAAO,CAACD,YAAY,CAAC,CAAC,CAACE,IAAI,CAAC,CAAC;MACjE3B,OAAO,CAACmB,GAAG,CAAC,gBAAgB,EAAEM,YAAY,CAACL,QAAQ,CAAC,CAAC,CAAC;MAEtD,MAAMQ,eAAe,GAAG,EAAE;MAC1B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,MAAM,CAACL,YAAY,CAAC,EAAEI,CAAC,EAAE,EAAE;QAC7C,MAAME,OAAO,GAAG,MAAMhD,QAAQ,CAAC2C,OAAO,CAAC7C,QAAQ,CAACgD,CAAC,CAAC,CAACF,IAAI,CAAC,CAAC;QACzD3B,OAAO,CAACmB,GAAG,CAACY,OAAO,CAACC,YAAY,CAAC;QACjCJ,eAAe,CAACK,IAAI,CAACF,OAAO,CAAC;MAC/B;MAEAjD,WAAW,CAAC8C,eAAe,CAAC;IAC9B,CAAC,CAAC,OAAO7B,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD;EACF,CAAC;EAED,MAAMmC,UAAU,GAAG,MAAOC,CAAC,IAAK;IAC9BA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,MAAMC,IAAI,GAAGF,CAAC,CAACG,MAAM;IACrB,MAAMC,WAAW,GAAGF,IAAI,CAACE,WAAW,CAACC,KAAK;IAC1C,MAAMC,mBAAmB,GAAGJ,IAAI,CAACI,mBAAmB,CAACD,KAAK;IAC1D,MAAME,sBAAsB,GAAGL,IAAI,CAACK,sBAAsB,CAACF,KAAK;IAChE,MAAMG,SAAS,GAAGN,IAAI,CAACM,SAAS,CAACH,KAAK,KAAK,MAAM;IACjD,MAAMI,YAAY,GAAG9E,IAAI,CAACwD,KAAK,CAACuB,KAAK,CAACR,IAAI,CAACO,YAAY,CAACJ,KAAK,EAAE,OAAO,CAAC;IAEvExC,OAAO,CAACmB,GAAG,CAACyB,YAAY,CAAC;IAEzB,IAAI,CAACL,WAAW,IAAI,CAACE,mBAAmB,EAAE;MACxCK,KAAK,CAAC,gDAAgD,CAAC;MACvD;IACF;IAEA,IAAI;MACF,MAAMC,iBAAiB,GAAG,MAAM9B,WAAW,CAAC,CAAC,CAAC,CAAC;MAC/C,MAAM+B,cAAc,GAAGD,iBAAiB,CAAC3B,QAAQ,CAAC,CAAC,CAAC,CAAC;MACrDpB,OAAO,CAACmB,GAAG,CAAC4B,iBAAiB,CAAC;MAE9B,MAAMhE,QAAQ,CAAC2C,OAAO,CAACQ,UAAU,CAC/BK,WAAW,EACXpE,OAAO,EACPsE,mBAAmB,EACnBtE,OAAO,EACPuE,sBAAsB,EACtBE,YAAY,EACZD,SACF,CAAC,CAACM,IAAI,CAAC;QAAEC,IAAI,EAAE/E,OAAO;QAAE+C,QAAQ,EAAE8B,cAAc;QAAER,KAAK,EAAEI,YAAY,GAAG;MAAI,CAAC,CAAC;MAC9E5C,OAAO,CAACmB,GAAG,CAAC,4BAA4B,CAAC;MACzCK,WAAW,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOzB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7C+C,KAAK,CAAC,6CAA6C,CAAC;IACtD;EACF,CAAC;EAGD,MAAMK,gBAAgB,GAAG,MAAAA,CAAOC,SAAS,EAAE/D,KAAK,KAAK;IACnD,IAAI;MACF,MAAMgE,UAAU,GAAGvF,IAAI,CAACwD,KAAK,CAACuB,KAAK,CAACxD,KAAK,EAAE,OAAO,CAAC;MACnDW,OAAO,CAACmB,GAAG,CAAC,aAAa,GAAE,OAAOiC,SAAU,GAAC,GAAG,GAAEA,SAAS,CAAChC,QAAQ,CAAC,CAAC,CAAC;MACvEpB,OAAO,CAACmB,GAAG,CAAC,WAAW,GAAGhD,OAAO,CAACiD,QAAQ,CAAC,CAAC,CAAC;MAE7C,MAAMrC,QAAQ,CAAC2C,OAAO,CAAC4B,iBAAiB,CAACF,SAAS,EAAEjF,OAAO,EAAE,eAAe,GAAGiF,SAAS,CAAC,CAAC;MAAA,CACvFH,IAAI,CAAC;QAAEC,IAAI,EAAE/E,OAAO;QAAEqE,KAAK,EAAEa;MAAW,CAAC,CAAC;MAE7CrD,OAAO,CAACmB,GAAG,CAAC,gCAAgC,CAAC;MAC7CK,WAAW,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOzB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;EAED,MAAMwD,kBAAkB,GAAIxB,OAAO,IAAK;IACtCvC,kBAAkB,CAACuC,OAAO,CAAC;EAC7B,CAAC;EAED,oBACE9D,OAAA;IAAAG,QAAA,gBACEH,OAAA,CAACC,gBAAgB;MAACC,OAAO,EAAEA;IAAQ;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAEtCP,OAAA;MAAMuF,QAAQ,EAAEtB,UAAW;MAAA9D,QAAA,gBACzBH,OAAA;QAAOwF,OAAO,EAAC,aAAa;QAAArF,QAAA,EAAC;MAAa;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAClDP,OAAA;QAAOyF,IAAI,EAAC,MAAM;QAACC,EAAE,EAAC,aAAa;QAACC,IAAI,EAAC,aAAa;QAACC,QAAQ;MAAA;QAAAxF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAClEP,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACNP,OAAA;QAAOwF,OAAO,EAAC,qBAAqB;QAAArF,QAAA,EAAC;MAAc;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC3DP,OAAA;QAAOyF,IAAI,EAAC,MAAM;QAACC,EAAE,EAAC,qBAAqB;QAACC,IAAI,EAAC,qBAAqB;QAACC,QAAQ;MAAA;QAAAxF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAClFP,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACNP,OAAA;QAAOwF,OAAO,EAAC,wBAAwB;QAAArF,QAAA,EAAC;MAAiB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eACjEP,OAAA;QAAOyF,IAAI,EAAC,MAAM;QAACC,EAAE,EAAC,wBAAwB;QAACC,IAAI,EAAC,wBAAwB;QAACC,QAAQ;MAAA;QAAAxF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACxFP,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACNP,OAAA;QAAOwF,OAAO,EAAC,WAAW;QAAArF,QAAA,EAAC;MAAS;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC5CP,OAAA;QAAQ0F,EAAE,EAAC,WAAW;QAACC,IAAI,EAAC,WAAW;QAAAxF,QAAA,gBACrCH,OAAA;UAAQuE,KAAK,EAAC,MAAM;UAAApE,QAAA,EAAC;QAAI;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAClCP,OAAA;UAAQuE,KAAK,EAAC,OAAO;UAAApE,QAAA,EAAC;QAAK;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9B,CAAC,eACTP,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACNP,OAAA;QAAOwF,OAAO,EAAC,cAAc;QAAArF,QAAA,EAAC;MAAoB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC1DP,OAAA;QAAOyF,IAAI,EAAC,QAAQ;QAACC,EAAE,EAAC,cAAc;QAACC,IAAI,EAAC,cAAc;QAACE,IAAI,EAAC,MAAM;QAACD,QAAQ;MAAA;QAAAxF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAClFP,OAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACNP,OAAA;QAAQyF,IAAI,EAAC,QAAQ;QAAAtF,QAAA,EAAC;MAAW;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC,eACbP,OAAA;MAAAI,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eACDP,OAAA;MAAQ8F,OAAO,EAAEvC,WAAY;MAAApD,QAAA,EAAC;IAAY;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACnDP,OAAA;MAAAG,QAAA,EACGS,QAAQ,CAACmF,GAAG,CAAC,CAACjC,OAAO,EAAEkC,KAAK;QAAA,IAAAC,qBAAA;QAAA,oBAC3BjG,OAAA;UAAAG,QAAA,GAAiB,gBACD,EAAC2D,OAAO,CAACC,YAAY,EAAC,IACpC,eAAA/D,OAAA;YAAM8F,OAAO,EAAEA,CAAA,KAAMR,kBAAkB,CAACxB,OAAO,CAAE;YAAA3D,QAAA,GAAC,MAC9C,EAAC2D,OAAO,CAAC4B,EAAE,CAACvC,QAAQ,CAAC,CAAC,EAAC,IAC3B;UAAA;YAAA/C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,aACE,EAACuD,OAAO,CAAC6B,IAAI,EAAC,oBACR,EAAC7B,OAAO,CAACoC,YAAY,EAAC,oBACtB,EAACpC,OAAO,CAACqC,YAAY,EAAC,uBACnB,EAACrC,OAAO,CAACsC,eAAe,EAAC,YACpC,EAACvG,IAAI,CAACwD,KAAK,CAACgD,OAAO,CAACvC,OAAO,CAAC1C,KAAK,EAAE,OAAO,CAAC,EAAC,mBACzC,EAAC0C,OAAO,CAACY,SAAS,CAACvB,QAAQ,CAAC,CAAC,EACtCW,OAAO,CAACY,SAAS,IAAIZ,OAAO,CAACqC,YAAY,CAAChD,QAAQ,CAAC,CAAC,CAACmD,WAAW,CAAC,CAAC,IAAIpG,OAAO,iBAC5EF,OAAA;YAAQ8F,OAAO,EAAEA,CAAA,KAAMZ,gBAAgB,CAACpB,OAAO,CAAC4B,EAAE,EAAE7F,IAAI,CAACwD,KAAK,CAACgD,OAAO,CAACvC,OAAO,CAAC1C,KAAK,EAAE,OAAO,CAAC,CAAE;YAAAjB,QAAA,EAAC;UAEnG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CACP,eACDP,OAAA;YAAAG,QAAA,EAAI;UAAkB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACnCP,OAAA;YAAAG,QAAA,EACG,CAAA2D,OAAO,aAAPA,OAAO,wBAAAmC,qBAAA,GAAPnC,OAAO,CAAEyC,gBAAgB,cAAAN,qBAAA,uBAAzBA,qBAAA,CAA2BO,MAAM,IAAG,CAAC,GACtC1C,OAAO,CAACyC,gBAAgB,CAACR,GAAG,CAAC,CAACU,KAAK,EAAEC,UAAU,kBAC7C1G,OAAA;cAAAG,QAAA,GAAqB,kBACH,EAACsG,KAAK,CAACE,QAAQ,EAAC,MAAI,EAAC,IAAIC,IAAI,CAACH,KAAK,CAACI,SAAS,GAAG,IAAI,CAAC,CAACC,cAAc,CAAC,CAAC,EAAC,eAC7E,EAACL,KAAK,CAACM,WAAW;YAAA,GAFrBL,UAAU;cAAAtG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAGf,CACL,CAAC,gBACAP,OAAA;cAAAG,QAAA,EAAI;YAA8B;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI;UACvC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC;QAAA,GA3BWyF,KAAK;UAAA5F,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OA4BV,CAAC;MAAA,CACP;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,EAGJe,eAAe,iBACpBtB,OAAA;MAAAG,QAAA,gBACEH,OAAA;QAAAG,QAAA,EAAI;MAAwB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAEjCP,OAAA;QAAAG,QAAA,GAAG,MAAI,EAACmB,eAAe,CAACoE,EAAE,CAACvC,QAAQ,CAAC,CAAC;MAAA;QAAA/C,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAEvC,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAEQ,CAAC;AAEV;AAACG,EAAA,CAvNQD,GAAG;AAAAuG,GAAA,GAAHvG,GAAG;AAyNZ,eAAeA,GAAG;AAAC,IAAAD,EAAA,EAAAwG,GAAA;AAAAC,YAAA,CAAAzG,EAAA;AAAAyG,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}